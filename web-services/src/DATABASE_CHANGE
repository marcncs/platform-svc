ALTER TABLE STOCK_ALTER_MOVE_IDCODE
ADD ( BONUSPOINT NUMBER NULL  ) ;

COMMENT ON COLUMN STOCK_ALTER_MOVE_IDCODE.BONUSPOINT IS '获取积分';

CREATE SEQUENCE SEQ_AFFICHE_BROWSE
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER; 

--新增删除过期验证码任务
INSERT INTO TASK_QUARTZ VALUES ((select max(id)+1 from TASK_QUARTZ), '删除过期验证码任务', null, null, '0', null, '0', null, null, '2', '删除过期验证码任务', 'ClearSMSValidateCodeTask', null, '30', null, null, null, null, '0', null, '1', null, null, null, null);

ClearSMSValidateCodeTask=com.winsafe.quartz.task.ClearSMSValidateCodeTask

periodOfCodeValidityInSecond=600 

---------------updated to BCS_RI---------------------

---2016-08-15---积分设置新增导入导出菜单---
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导入',(select id from LEFT_MENU where LMENUNAME='积分设置'),'积分设置','1');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导入'and MODULENAME='积分设置'),
'/keyretailer/toImportSBonusSettingAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导入'and MODULENAME='积分设置'),
'/keyretailer/importSBonusSettingAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='积分设置'),'积分设置','1');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='积分设置'),
'/keyretailer/exportSBonusSettingAction.do');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='区域管理'),
'/keyretailer/listSUserAreaAction.do');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='区域管理'),
'/keyretailer/listSCustomerAreaAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='区域管理'),
'/keyretailer/listSBonusAreaAction.do');

CREATE TABLE S_CUSTOMER_AREA (
ID NUMBER NOT NULL ,
ORGANID VARCHAR2(32) NULL ,
AREAID NUMBER NULL ,
REMARK VARCHAR2(512) NULL ,
MODIFIEDDATE DATE NULL ,
VERSION NUMBER NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN S_CUSTOMER_AREA.ORGANID IS '机构编号';

COMMENT ON COLUMN S_CUSTOMER_AREA.AREAID IS '区域编号';

COMMENT ON COLUMN S_CUSTOMER_AREA.REMARK IS '备注';

COMMENT ON COLUMN S_CUSTOMER_AREA.MODIFIEDDATE IS '修改日期';

CREATE SEQUENCE S_CUSTOMER_AREA_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'新增区域用户',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增区域用户'and MODULENAME='区域管理'),
'/keyretailer/toAddSUserAreaAction.do');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增区域用户'and MODULENAME='区域管理'),
'/keyretailer/addSUserAreaAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'删除区域用户',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='删除区域用户'and MODULENAME='区域管理'),
'/keyretailer/delSUserAreaAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'新增区域机构',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增区域机构'and MODULENAME='区域管理'),
'/keyretailer/toAddSCustomerAreaAction.do');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增区域机构'and MODULENAME='区域管理'),
'/keyretailer/addSCustomerAreaAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'删除区域机构',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='删除区域机构'and MODULENAME='区域管理'),
'/keyretailer/delSCustomerAreaAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出区域用户',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出区域用户'and MODULENAME='区域管理'),
'/keyretailer/exportSUserAreaAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出区域机构',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出区域机构'and MODULENAME='区域管理'),
'/keyretailer/exportSCustomerAreaAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导入区域用户',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导入区域用户'and MODULENAME='区域管理'),
'/keyretailer/toImportSUserAreaAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导入区域用户'and MODULENAME='区域管理'),
'/keyretailer/importSUserAreaAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导入区域机构',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导入区域机构'and MODULENAME='区域管理'),
'/keyretailer/toImportSCustomerAreaAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导入区域机构'and MODULENAME='区域管理'),
'/keyretailer/importSCustomerAreaAction.do');


---2016--09--18---
--ALTER TABLE S_BONUS_APPRAISE
--ADD ( ISSUPPORTED NUMBER NULL  ) ;

--COMMENT ON COLUMN S_BONUS_APPRAISE.ISSUPPORTED IS '是否被支持';


ALTER TABLE S_BONUS_TARGET
ADD ( ISSUPPORTED NUMBER NULL  ) ;

COMMENT ON COLUMN S_BONUS_TARGET.ISSUPPORTED IS '是否被支持';

ALTER TABLE S_BONUS_TARGET
ADD ( REBATE NUMBER NULL  ) ;

COMMENT ON COLUMN S_BONUS_TARGET.REBATE IS '返利积分';

---2016--09--22---
CREATE SEQUENCE BCS_RI_COMMON_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;


CREATE TABLE S_BONUS_CONFIG (
ID NUMBER NOT NULL ,
YEAR NUMBER NULL ,
STARTDATE DATE NULL ,
ENDDATE DATE NULL ,
MAKEDATE DATE NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN S_BONUS_CONFIG.ID IS '编号';

COMMENT ON COLUMN S_BONUS_CONFIG.YEAR IS '年度';

COMMENT ON COLUMN S_BONUS_CONFIG.STARTDATE IS '开始时间';

COMMENT ON COLUMN S_BONUS_CONFIG.ENDDATE IS '结束时间';

COMMENT ON COLUMN S_BONUS_CONFIG.MAKEDATE IS '创建日期';

ALTER TABLE S_BONUS_PERIOD
ADD ( ISCOUNTED NUMBER NULL  ) ;

COMMENT ON COLUMN S_BONUS_PERIOD.ISCOUNTED IS '是否已统计';

ALTER TABLE S_BONUS_CONFIG
ADD ( VALUE VARCHAR2(32) NULL  ) 
ADD ( CONFIGTYPE NUMBER NULL  ) ;

COMMENT ON COLUMN S_BONUS_CONFIG.VALUE IS '值';

COMMENT ON COLUMN S_BONUS_CONFIG.CONFIGTYPE IS '配置类型';

ALTER TABLE S_BONUS_CONFIG
ADD ( VERSION NUMBER NULL  ) ;


INSERT INTO LEFT_MENU VALUES ('406', '积分参数设置', 'd.add(406,40,"积分参数设置","../keyretailer/listSBonusConfigAction.do","积分参数设置","","","");', '40', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='积分参数设置'),'积分参数设置','1');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='积分参数设置'),
'/keyretailer/listSBonusConfigAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'新增',(select id from LEFT_MENU where LMENUNAME='积分参数设置'),'积分参数设置','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='积分参数设置'),
'/keyretailer/toAddSBonusConfigAction.do');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='积分参数设置'),
'/keyretailer/addSBonusConfigAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'修改',(select id from LEFT_MENU where LMENUNAME='积分参数设置'),'积分参数设置','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='积分参数设置'),
'/keyretailer/toUpdSBonusConfigAction.do');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='积分参数设置'),
'/keyretailer/updSBonusConfigAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'删除',(select id from LEFT_MENU where LMENUNAME='积分参数设置'),'积分参数设置','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='删除'and MODULENAME='积分参数设置'),
'/keyretailer/delSBonusConfigAction.do');

--2016-09-26--
CREATE TABLE SALES_AREA_COUNTRY (
ID NUMBER NOT NULL ,
SALESAREAID NUMBER NULL ,
COUNTRYAREAID NUMBER NULL ,
MAKEDATE DATE NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN SALES_AREA_COUNTRY.SALESAREAID IS '销售区域编号';

COMMENT ON COLUMN SALES_AREA_COUNTRY.COUNTRYAREAID IS '行政区域编号';

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看关联行政区域',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看关联行政区域'and MODULENAME='区域管理'),
'/keyretailer/listSalesAreaCountryAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'关联行政区域',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='关联行政区域'and MODULENAME='区域管理'),
'/keyretailer/toAddSalesAreaCountryAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='关联行政区域'and MODULENAME='区域管理'),
'/keyretailer/addSalesAreaCountryAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'解除关联行政区域',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='解除关联行政区域'and MODULENAME='区域管理'),
'/keyretailer/delSalesAreaCountryAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出关联行政区域',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出关联行政区域'and MODULENAME='区域管理'),
'/keyretailer/exportSalesAreaCountryAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导入关联行政区域',(select id from LEFT_MENU where LMENUNAME='区域管理'),'区域管理','1');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导入关联行政区域'and MODULENAME='区域管理'),
'/keyretailer/toImportSalesAreaCountryAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导入关联行政区域'and MODULENAME='区域管理'),
'/keyretailer/importSalesAreaCountryAction.do');


INSERT INTO BASE_RESOURCE
select (select max(id)+1 from BASE_RESOURCE),'SalesUserType',1,'RM',NULL,1 from dual;

INSERT INTO BASE_RESOURCE
select (select max(id)+1 from BASE_RESOURCE),'SalesUserType',2,'ASM',NULL,1 from dual;

INSERT INTO BASE_RESOURCE
select (select max(id)+1 from BASE_RESOURCE),'SalesUserType',3,'SS',NULL,1 from dual;

INSERT INTO BASE_RESOURCE
select (select max(id)+1 from BASE_RESOURCE),'SalesUserType',4,'SR',NULL,1 from dual;

update MAKE_CONF set CURRENTVALUE = CURRENTVALUE + 1 where TABLENAME = 'base_resource'


CREATE TABLE USER_CUSTOMER (
ID NUMBER NOT NULL ,
USERID NUMBER NULL ,
ORGANID VARCHAR2(32) NULL ,
MAKEDATE DATE NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;



INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看关联客户',(select id from LEFT_MENU where LMENUNAME='用户管理'),'用户管理','1');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看关联客户'and MODULENAME='用户管理'),
'/keyretailer/listUserCustomerAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'新增关联客户',(select id from LEFT_MENU where LMENUNAME='用户管理'),'用户管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增关联客户'and MODULENAME='用户管理'),
'/keyretailer/toAddUserCustomerAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增关联客户'and MODULENAME='用户管理'),
'/keyretailer/addUserCustomerAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'删除关联客户',(select id from LEFT_MENU where LMENUNAME='用户管理'),'用户管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='删除关联客户'and MODULENAME='用户管理'),
'/keyretailer/delUserCustomerAction.do');


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看关联销售人员',(select id from LEFT_MENU where LMENUNAME='机构设置'),'机构设置','1');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看关联销售人员'and MODULENAME='机构设置'),
'/keyretailer/listOrganUserAction.do');


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'设置银河会员',(select id from LEFT_MENU where LMENUNAME='机构设置'),'机构设置','1');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='设置银河会员'and MODULENAME='机构设置'),
'/keyretailer/setKeyRetaikerFlagAction.do');



ALTER TABLE S_BONUS_TARGET
ADD ( FINALBONUSPOINT NUMBER NULL  ) ;

COMMENT ON COLUMN S_BONUS_TARGET.FINALBONUSPOINT IS '最终积分';

ALTER TABLE S_BONUS_LOG
ADD ( ORGANID VARCHAR2(32) NULL  ) ;

COMMENT ON COLUMN S_BONUS_LOG.ORGANID IS '机构编号';


CREATE TABLE AFFICHE_USER (
ID NUMBER NOT NULL ,
USERID NUMBER NULL ,
AFFICHEID NUMBER NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN AFFICHE_USER.USERID IS '用户编号';

COMMENT ON COLUMN AFFICHE_USER.AFFICHEID IS '消息编号';

CREATE SEQUENCE AFFICHE_USER_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;


INSERT INTO LEFT_MENU VALUES ('407', '支持度评价设置', 'd.add(407,40,"支持度评价设置","../keyretailer/listSBonusAppraiseSettingAction.do","支持度评价设置","","","");', '40', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='支持度评价设置'),'支持度评价设置','1');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='支持度评价设置'),
'/keyretailer/listSBonusAppraiseSettingAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'设置',(select id from LEFT_MENU where LMENUNAME='支持度评价设置'),'支持度评价设置','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='设置'and MODULENAME='支持度评价设置'),
'/keyretailer/updSBonusAppraiseSettingAction.do');



INSERT INTO TASK_QUARTZ VALUES ((select max(id)+1 from TASK_QUARTZ), '积分返利统计任务', null, null, '0', null, '0', null, null, '2', '积分返利统计任务', 'AutoBonusRebateTask', null, '30', null, null, null, null, '0', null, '1', null, null, null, null);


ALTER TABLE S_BONUS_TARGET
ADD ( ISCONFIRMED NUMBER DEFAULT 0 NULL  ) 
ADD ( ISCOMPLETE NUMBER DEFAULT 0 NULL ) ;

COMMENT ON COLUMN S_BONUS_TARGET.ISCONFIRMED IS '是否已由客户确认';

COMMENT ON COLUMN S_BONUS_TARGET.ISCOMPLETE IS '是否已由管理员确认';


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='支持度评价设置'),'支持度评价设置','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='支持度评价设置'),
'/keyretailer/exputAddSBonusAppraiseSettingAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'确认',(select id from LEFT_MENU where LMENUNAME='支持度评价设置'),'支持度评价设置','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='确认'and MODULENAME='支持度评价设置'),
'/keyretailer/completeSBonusAppraiseSettingAction.do');




INSERT INTO LEFT_MENU VALUES ('408', '积分报表', 'd.add(408,40,"积分报表","../keyretailer/listSBonusReportAction.do","积分报表","","","");', '40', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='积分报表'),'积分报表','1');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='积分报表'),
'/keyretailer/listSBonusReportAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='积分报表'),'积分报表','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='积分报表'),
'/keyretailer/exportSBonusReportAction.do');

ALTER TABLE S_BONUS_TARGET 
ADD ( SUPPORTDATE DATE NULL  ) 
ADD ( CONFIRMDATE DATE NULL  ) 
ADD ( COMPLETEDATE DATE NULL  ) ;

COMMENT ON COLUMN S_BONUS_TARGET.SUPPORTDATE IS '设置支持日期';

COMMENT ON COLUMN S_BONUS_TARGET.CONFIRMDATE IS '客户返利确认日期';

COMMENT ON COLUMN S_BONUS_TARGET.COMPLETEDATE IS '管理员确认日期';


INSERT INTO LEFT_MENU VALUES ('409', '收发货汇总报表', 'd.add(409,40,"收发货汇总报表","../keyretailer/listRecAndDisSumReportAction.do","收发货汇总报表","","","");', '40', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='收发货汇总报表'),'收发货汇总报表','1');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='收发货汇总报表'),
'/keyretailer/listRecAndDisSumReportAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='收发货汇总报表'),'收发货汇总报表','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='收发货汇总报表'),
'/keyretailer/exportRecAndDisSumReportAction.do');


INSERT INTO S_BONUS_AREA 
select -1,-1,'全国',NULL,NULL,sysdate,0,-1 from dual


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',1,
'/keyretailer/selectOrganAction.do');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',1,'/sBonusAreaAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',1,'/keyretailer/ajaxSbonusAreaAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='积分明细'),'积分明细','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='积分明细'),
'/keyretailer/exportSBonusDetailAction.do');


-----------2016-11-21---
INSERT INTO LEFT_MENU VALUES ('2333', '杜邦码导入日志', 'd.add(2333,10,"杜邦码导入日志","../erp/listDupontCodeUploadLogAction.do","杜邦码导入日志","","","");', '10', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='杜邦码导入日志'),'杜邦码导入日志','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='杜邦码导入日志'),
'/erp/listDupontCodeUploadLogAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导入',(select id from LEFT_MENU where LMENUNAME='杜邦码导入日志'),'杜邦码导入日志','1');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导入'and MODULENAME='杜邦码导入日志'),
'/erp/toImportDupontPrimaryCode.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导入'and MODULENAME='杜邦码导入日志'),
'/erp/importDupontPrimaryCode.do');



INSERT INTO LEFT_MENU VALUES ('2334', '杜邦码关系查询', 'd.add(2334,10,"杜邦码关系查询","../erp/listDupontPrimaryCode.do","杜邦码关系查询","","","");', '10', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='杜邦码关系查询'),'杜邦码关系查询','1');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='杜邦码关系查询'),
'/erp/listDupontPrimaryCode.do');



CREATE TABLE DUPONT_PRIMARY_CODE (
PRIMARYCODE VARCHAR2(16) NOT NULL ,
DPCARTONCODE VARCHAR2(32) NULL ,
BCSCARTONCODE VARCHAR2(32) NULL ,
BCSTDCODE VARCHAR2(64) NULL ,
DPPALLETCODE VARCHAR2(32) NULL ,
MATERIALCODE VARCHAR2(16) NULL ,
PRODUCTIONDATE DATE NULL ,
DPBATCH VARCHAR2(16) NULL ,
BCSBATCH VARCHAR2(16) NULL ,
MAKEDATE DATE NULL ,
UPLOADID NUMBER NULL ,
PRIMARY KEY (PRIMARYCODE)
)
NOCOMPRESS
;

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.PRIMARYCODE IS '小包装码（激光码）';

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.DPCARTONCODE IS '杜邦箱号';

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.BCSCARTONCODE IS '拜耳箱号';

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.BCSTDCODE IS '拜耳标签二维码';

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.DPPALLETCODE IS '杜邦托码';

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.MATERIALCODE IS '物料编号';

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.PRODUCTIONDATE IS '生产日期';

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.DPBATCH IS '杜邦批号';

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.BCSBATCH IS '拜耳批号';

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.MAKEDATE IS '新增日期';

COMMENT ON COLUMN DUPONT_PRIMARY_CODE.UPLOADID IS '上传日志编号';

CREATE INDEX DUPC_IX1
ON DUPONT_PRIMARY_CODE (DPCARTONCODE ASC);

CREATE INDEX DUPC_IX2
ON DUPONT_PRIMARY_CODE (BCSCARTONCODE ASC);


/*
Navicat Oracle Data Transfer
Oracle Client Version : 10.2.0.5.0

Source Server         : 192.168.20.21_1521_ORCL
Source Server Version : 110200
Source Host           : 192.168.20.21:1521
Source Schema         : DBOBCSRTCI20141114

Target Server Type    : ORACLE
Target Server Version : 110200
File Encoding         : 65001

Date: 2016-11-21 18:58:17
*/


-- ----------------------------
-- Table structure for DUPONT_CODE_UPLOAD_LOG
-- ----------------------------
CREATE TABLE DUPONT_CODE_UPLOAD_LOG (
ID NUMBER NOT NULL ,
FILENAME VARCHAR2(256 CHAR) NULL ,
FILEPATH VARCHAR2(256 CHAR) NULL ,
LOGFILEPATH VARCHAR2(256 CHAR) NULL ,
ERRORCOUNT NUMBER NULL ,
TOTALCOUNT NUMBER NULL ,
MAKEID NUMBER NULL ,
MAKEORGANID VARCHAR2(50 CHAR) NULL ,
MAKEDATE DATE NULL ,
FILEHASHCODE VARCHAR2(512 CHAR) NULL
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.ID IS '序号';
COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.FILENAME IS '上传文件名称';
COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.FILEPATH IS '上传文件路径';
COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.LOGFILEPATH IS '错误日志文件全名';
COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.ERRORCOUNT IS '错误记录数';
COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.TOTALCOUNT IS '总记录数';
COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.MAKEID IS '创建用户号';
COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.MAKEORGANID IS '创建机构号';
COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.MAKEDATE IS '创建日期';
COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.FILEHASHCODE IS '文件对比码（判断是否同一文件使用）';


CREATE SEQUENCE DUPONT_CODE_UPLOAD_LOG_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;


ALTER TABLE DUPONT_CODE_UPLOAD_LOG
ADD ( CODEFILEPATH VARCHAR2(256) NULL  ) ;

COMMENT ON COLUMN DUPONT_CODE_UPLOAD_LOG.CODEFILEPATH IS '条码文件路径';


INSERT INTO LEFT_MENU VALUES ('410', '积分返利', 'd.add(410,40,"积分返利","../keyretailer/listSBonusAppraiseSettingAction.do?type=1","积分返利","","","");', '40', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'确认',(select id from LEFT_MENU where LMENUNAME='积分返利'),'积分返利','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='确认'and MODULENAME='积分返利'),
'/keyretailer/toConfirmSBonusAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='确认'and MODULENAME='积分返利'),
'/keyretailer/confirmSBonusAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='积分返利'),'积分返利','1');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='积分返利'),
'/keyretailer/listSBonusAppraiseSettingAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'上传积分计划协议',(select id from LEFT_MENU where LMENUNAME='积分目标'),'积分目标','1');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='上传积分计划协议'and MODULENAME='积分目标'),
'/keyretailer/uploadSBonusFileAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='上传积分计划协议'and MODULENAME='积分目标'),
'/keyretailer/toUploadSBonusFileAction.do');


update OPERATE set MODULEID=(select id FROM LEFT_MENU where lmenuname='积分返利'),MODULENAME='积分返利' 
where operatename='导出' and MODULEID=(select id FROM LEFT_MENU where lmenuname='支持度评价设置')


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='上传积分计划协议'and MODULENAME='积分目标'),
'/keyretailer/toUploadSBonusFileAction.do');


"/keyretailer/toImportSBonusAgreementAction"


ALTER TABLE ORGAN
ADD ( CREATIONTIME DATE NULL  ) 
ADD ( MODIFICATIONTIME DATE NULL  ) ;
---新增数量盘点和条码盘点
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'审核',(select id from LEFT_MENU
 where LMENUNAME='数量盘点'),'数量盘点','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='审核'
and MODULENAME='数量盘点'),
'/warehouse/ConfirmProductStockDifference.do');

ALTER TABLE BARCODE_INVENTORY
ADD ( ISAPPROVE NUMBER NULL  ) ;

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'审核',(select id from LEFT_MENU where LMENUNAME='条码盘点'),'条码盘点','1');
iNSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='审核'and MODULENAME='条码盘点'),
<<<<<<< .mine
'/warehouse/approveBarcodeInventoryAction.do');

iNSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='机构设置'),
'/common/SelectOrganWlinkmanAction.do');

------------2017-05-18-------------

CREATE TABLE INVENTORY_DETAIL_HISTORY (
YEAR NUMBER NULL ,
MONTH NUMBER NULL ,
ORGANID VARCHAR2(32) NULL ,
OECODE VARCHAR2(32) NULL ,
PRODUCTID VARCHAR2(32) NULL ,
STOCKPILE NUMBER NULL ,
STOCKPILEINTRANSIT NUMBER NULL ,
STOCKPILETOSHIP NUMBER NULL ,
WAREHOUSEID VARCHAR2(32) NULL ,
BATCH VARCHAR2(32) NULL 
)
NOCOMPRESS
;

COMMENT ON COLUMN INVENTORY_DETAIL_HISTORY.YEAR IS '年份';

COMMENT ON COLUMN INVENTORY_DETAIL_HISTORY.MONTH IS '月份';

COMMENT ON COLUMN INVENTORY_DETAIL_HISTORY.ORGANID IS '机构编号';

COMMENT ON COLUMN INVENTORY_DETAIL_HISTORY.OECODE IS '机构内部编号';

COMMENT ON COLUMN INVENTORY_DETAIL_HISTORY.PRODUCTID IS '产品编号';

COMMENT ON COLUMN INVENTORY_DETAIL_HISTORY.STOCKPILE IS '在仓库存';

COMMENT ON COLUMN INVENTORY_DETAIL_HISTORY.STOCKPILEINTRANSIT IS '在途库存';

COMMENT ON COLUMN INVENTORY_DETAIL_HISTORY.STOCKPILETOSHIP IS '待发库存';

COMMENT ON COLUMN INVENTORY_DETAIL_HISTORY.WAREHOUSEID IS '仓库编号';

COMMENT ON COLUMN INVENTORY_DETAIL_HISTORY.BATCH IS '批次';



CREATE TABLE CONSUME_DETAIL_HISTORY (
YEAR NUMBER NULL ,
MONTH NUMBER NULL ,
BILLNO VARCHAR2(32) NULL ,
ORGANID VARCHAR2(32) NULL ,
OECODE VARCHAR2(32) NULL ,
PRODUCTID VARCHAR2(32) NULL ,
BATCH VARCHAR2(32) NULL ,
CONSUMEQUANTITY NUMBER NULL ,
MAKEDATE DATE NULL ,
OUTORGANID VARCHAR2(32) NULL ,
OUTWAREHOUSEID VARCHAR2(32) NULL 
)
NOCOMPRESS
;

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.YEAR IS '年';

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.MONTH IS '月';

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.BILLNO IS '单据号';

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.ORGANID IS '机构编号';

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.OECODE IS '机构内部编码';

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.PRODUCTID IS '产品编号';

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.BATCH IS '批次';

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.CONSUMEQUANTITY IS '消耗数量';

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.MAKEDATE IS '审核日期';

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.OUTORGANID IS '出货机构';

COMMENT ON COLUMN CONSUME_DETAIL_HISTORY.OUTWAREHOUSEID IS '出货仓库';


CREATE TABLE SALES_DETAIL_HISTORY (
YEAR NUMBER NULL ,
MONTH NUMBER NULL ,
BILLNO VARCHAR2(32) NULL ,
ORGANID VARCHAR2(32) NULL ,
OECODE VARCHAR2(32) NULL ,
PRODUCTID VARCHAR2(32) NULL ,
BATCH VARCHAR2(32) NULL ,
SALESQUANTITY NUMBER NULL ,
MAKEDATE DATE NULL ,
WAREHOUSEID VARCHAR2(32) NULL 
)
NOCOMPRESS
;


COMMENT ON COLUMN SALES_DETAIL_HISTORY.YEAR IS '年';

COMMENT ON COLUMN SALES_DETAIL_HISTORY.MONTH IS '月';

COMMENT ON COLUMN SALES_DETAIL_HISTORY.BILLNO IS '单据号';

COMMENT ON COLUMN SALES_DETAIL_HISTORY.ORGANID IS '机构编号';

COMMENT ON COLUMN SALES_DETAIL_HISTORY.OECODE IS '机构内部编码';

COMMENT ON COLUMN SALES_DETAIL_HISTORY.PRODUCTID IS '产品编号';

COMMENT ON COLUMN SALES_DETAIL_HISTORY.BATCH IS '批次';

COMMENT ON COLUMN SALES_DETAIL_HISTORY.SALESQUANTITY IS '销售数量';

COMMENT ON COLUMN SALES_DETAIL_HISTORY.MAKEDATE IS '审核日期';

COMMENT ON COLUMN SALES_DETAIL_HISTORY.WAREHOUSEID IS '仓库编号';


INSERT INTO LEFT_MENU VALUES ('3029', '销售明细历史', 'd.add(3029,30,"销售明细历史","../report/listSalesDetailHistoryAction.do","销售明细历史","","","");', '30', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='销售明细历史'),'销售明细历史','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='销售明细历史'),
'/report/listSalesDetailHistoryAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='销售明细历史'),'销售明细历史','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='销售明细历史'),
'/report/excputSalesDetailHistoryAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'更新',(select id from LEFT_MENU where LMENUNAME='销售明细历史'),'销售明细历史','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='更新'and MODULENAME='销售明细历史'),
'/report/toUpdSalesDetailHistoryAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='更新'and MODULENAME='销售明细历史'),
'/report/updSalesDetailHistoryAction.do');

INSERT INTO LEFT_MENU VALUES ('3030', '消耗明细历史', 'd.add(3030,30,"消耗明细历史","../report/listConsumeDetailHistoryAction.do","消耗明细历史","","","");', '30', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='消耗明细历史'),'消耗明细历史','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='消耗明细历史'),
'/report/listConsumeDetailHistoryAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='消耗明细历史'),'消耗明细历史','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='消耗明细历史'),
'/report/excputConsumeDetailHistoryAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'更新',(select id from LEFT_MENU where LMENUNAME='消耗明细历史'),'消耗明细历史','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='更新'and MODULENAME='消耗明细历史'),
'/report/toUpdConsumeDetailHistoryAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='更新'and MODULENAME='消耗明细历史'),
'/report/updConsumeDetailHistoryAction.do');

INSERT INTO LEFT_MENU VALUES ('3031', '库存明细历史', 'd.add(3031,30,"库存明细历史","../report/listInventoryDetailHistoryAction.do","库存明细历史","","","");', '30', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='库存明细历史'),'库存明细历史','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='库存明细历史'),
'/report/listInventoryDetailHistoryAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='库存明细历史'),'库存明细历史','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='库存明细历史'),
'/report/excputInventoryDetailHistoryAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'更新',(select id from LEFT_MENU where LMENUNAME='库存明细历史'),'库存明细历史','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='更新'and MODULENAME='库存明细历史'),
'/report/toUpdInventoryDetailHistoryAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='更新'and MODULENAME='库存明细历史'),
'/report/updInventoryDetailHistoryAction.do');


ALTER TABLE SALES_DETAIL_HISTORY
ADD ( ISCOMPLETE NUMBER NULL  ) ;

COMMENT ON COLUMN SALES_DETAIL_HISTORY.ISCOMPLETE IS '是否已签收';



---------------2017-06-03----------------


INSERT INTO LEFT_MENU VALUES ('3032', '销售和消耗汇总报表(新)', 'd.add(3032,30,"销售和消耗汇总报表(新)","../report/salesConsumeReportAction.do?type=2","销售和消耗汇总报表(新)","","","");', '30', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='销售和消耗汇总报表(新)'),'销售和消耗汇总报表(新)','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='销售和消耗汇总报表(新)'),
'/report/salesConsumeReportAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='销售和消耗汇总报表(新)'),'销售和消耗汇总报表(新)','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='销售和消耗汇总报表(新)'),
'/report/excPutSalesConsumeReportAction.do');


INSERT INTO LEFT_MENU VALUES ('3033', '销售明细报表(新)', 'd.add(3033,30,"销售明细报表(新)","../report/salesDetailReportAction.do?type=2","销售明细报表(新)","","","");', '30', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='销售明细报表(新)'),'销售明细报表(新)','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='销售明细报表(新)'),
'/report/salesDetailReportAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='销售明细报表(新)'),'销售明细报表(新)','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='销售明细报表(新)'),
'/report/excPutSalesDetailReportAction.do');


INSERT INTO LEFT_MENU VALUES ('3034', '消耗明细报表(新)', 'd.add(3034,30,"消耗明细报表(新)","../report/consumeDetailReportAction.do?type=2","消耗明细报表(新)","","","");', '30', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='消耗明细报表(新)'),'消耗明细报表(新)','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='消耗明细报表(新)'),
'/report/consumeDetailReportAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='消耗明细报表(新)'),'消耗明细报表(新)','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='消耗明细报表(新)'),
'/report/excPutConsumeDetailReportAction.do');


INSERT INTO LEFT_MENU VALUES ('3035', '库存报表(新)', 'd.add(3035,30,"库存报表(新)","../report/pdInventoryReportAction.do?type=2","库存报表(新)","","","");', '30', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='库存报表(新)'),'库存报表(新)','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='库存报表(新)'),
'/report/pdInventoryReportAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='库存报表(新)'),'库存报表(新)','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='库存报表(新)'),
'/report/excputPDInventoryReportAction.do');


INSERT INTO LEFT_MENU VALUES ('3036', '库存明细报表(新)', 'd.add(3036,30,"库存明细报表(新)","../report/inventoryDetailReportAction.do?type=2","库存明细报表(新)","","","");', '30', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='库存明细报表(新)'),'库存明细报表(新)','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='库存明细报表(新)'),
'/report/inventoryDetailReportAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='库存明细报表(新)'),'库存明细报表(新)','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='库存明细报表(新)'),
'/report/excputInventoryDetailReportAction.do');



--新增密码历史表
CREATE TABLE PASSWORD_HISTORY (
USERID NUMBER NOT NULL ,
PASSWORD VARCHAR2(512) NOT NULL ,
MAKEDATE DATE NULL
)
NOCOMPRESS
;

--新增用户与用户类型关联表
CREATE TABLE USER_CATEGARY (
USERID NUMBER NOT NULL ,
CATEGARYID NUMBER NULL ,
MAKEDATE DATE NULL
)
NOCOMPRESS
;

COMMENT ON COLUMN USER_CATEGARY.USERID IS '用户编号';

COMMENT ON COLUMN USER_CATEGARY.CATEGARYID IS '用户类型';


--新增用户组表
CREATE TABLE USER_GROUP (
ID NUMBER NOT NULL ,
GROUPNAME VARCHAR2(128) NULL ,
DESCRIPTION VARCHAR2(512) NULL ,
MAKEDATE DATE NULL ,
ROLEID NUMBER NULL
)
NOCOMPRESS
;

COMMENT ON COLUMN USER_GROUP.ID IS '编号';

COMMENT ON COLUMN USER_GROUP.GROUPNAME IS '用户组名称';

COMMENT ON COLUMN USER_GROUP.DESCRIPTION IS '描述';

COMMENT ON COLUMN USER_GROUP.MAKEDATE IS '日期';

COMMENT ON COLUMN USER_GROUP.ROLEID IS '角色编号';


CREATE SEQUENCE USER_GROUP_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;

--新增用户组相关菜单
INSERT INTO LEFT_MENU VALUES ('2335', '用户组', 'd.add(2335,6,"用户组","../users/listUserGroupAction.do","用户组","","","");', '6', '2', '', '1', (select max(sort) + 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='用户组'),'用户组','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='用户组'),
'/users/listUserGroupAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='用户组'),
'/users/listUserGroupAppAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'新增',(select id from LEFT_MENU where LMENUNAME='用户组'),'用户组','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='用户组'),
'/users/toAddUserGroupAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='用户组'),
'/users/addUserGroupAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'修改',(select id from LEFT_MENU where LMENUNAME='用户组'),'用户组','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='用户组'),
'/users/toUpdUserGroupAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='用户组'),
'/users/updUserGroupAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='用户组'),
'/users/updUserGroupAppAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'删除',(select id from LEFT_MENU where LMENUNAME='用户组'),'用户组','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='删除'and MODULENAME='用户组'),
'/users/delUserGroupAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',1,'/common/selectRoleAction.do');

--新增用户组关联用户类型表
CREATE TABLE USER_GROUP_APP (
ID NUMBER NOT NULL ,
USERGROUPID NUMBER NOT NULL ,
APPID NUMBER NULL ,
MAKEDATE DATE NULL 
)
NOCOMPRESS
;

COMMENT ON COLUMN USER_GROUP_APP.ID IS '编号';

COMMENT ON COLUMN USER_GROUP_APP.USERGROUPID IS '用户组编号';

COMMENT ON COLUMN USER_GROUP_APP.APPID IS '应用程序编号';

COMMENT ON COLUMN USER_GROUP_APP.MAKEDATE IS '日期';

--新增用户类型信息
INSERT INTO BASE_RESOURCE 
select (select max(id)+1 from BASE_RESOURCE), 'Application',1,'RTCI',NULL,1 from dual;

INSERT INTO BASE_RESOURCE 
select (select max(id)+1 from BASE_RESOURCE), 'Application',2,'拜追踪',NULL,1 from dual;

INSERT INTO BASE_RESOURCE 
select (select max(id)+1 from BASE_RESOURCE), 'Application',3,'拜耳客户信息系统',NULL,1 from dual;

update MAKE_CONF set CURRENTVALUE = (select max(id)+1 from BASE_RESOURCE) where TABLENAME = 'base_resource';

--用户表新增是否CWID用户字段
ALTER TABLE USERS
ADD ( ISCWID NUMBER NULL  ) ;

COMMENT ON COLUMN USERS.ISCWID IS '是否CWID用户';

--新增IAM用户同步任务
INSERT INTO TASK_QUARTZ VALUES ((select max(id)+1 from TASK_QUARTZ), 'IAM用户同步任务', null, null, '0', null, '0', null, null, '2', 'IAM用户同步任务', 'DealSyncIAMUsersTask', null, '30', null, null, null, null, '0', null, '1', null, null, null, null);


--更新所有工厂用户为RTCI用户
INSERT INTO USER_CATEGARY
select userid, 1, SYSDATE from USERS u 
join organ o on u.makeorganid = o.id
and o.organtype = 1;

--更新所有TD用户为RTCI用户
INSERT INTO USER_CATEGARY
select userid, 1, SYSDATE from USERS u 
join organ o on u.makeorganid = o.id
and o.organtype = 2 and o.organmodel = 1;

--更新所有BKD/BKR用户为客户信息系统用户
INSERT INTO USER_CATEGARY
select userid, 3, SYSDATE from USERS u 
join organ o on u.makeorganid = o.id
and o.organtype = 2 and o.organmodel <> 1;

--初始化用户的密码有效期为当前日期的49天之后
update users set vad = SYSDATE+49

-------2017-08-01---
---修改用户表手机号字段长度--------
ALTER TABLE USERS
MODIFY ( MOBILE VARCHAR2(128 CHAR) ) ;

INSERT INTO TASK_QUARTZ VALUES ((select max(id)+1 from TASK_QUARTZ), '用户表手机号加密任务', null, null, '0', null, '0', null, null, '2', '用户表手机号加密任务', 'DealEncryptUserMobileTask', null, '30', null, null, null, null, '0', null, '1', null, null, null, null);

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',-1,'/common/ajaxGetIdentifyCodeAction.do');

------2017-08-11-----
ALTER TABLE USERS
ADD ( TRYCOUNT NUMBER NULL  ) 
ADD ( ISLOCKED NUMBER NULL  ) ;

COMMENT ON COLUMN USERS.TRYCOUNT IS '登陆失败尝试次数';

COMMENT ON COLUMN USERS.ISLOCKED IS '账号是否被锁定';

--新增解锁用户功能菜单
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'解锁',(select id from LEFT_MENU where LMENUNAME='用户管理'),'用户管理','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='解锁'and MODULENAME='用户管理'),
'/users/unlockUsersAction.do');


------------------2017-08-26--------------------------
CREATE TABLE USER_APPLY (
USERID NUMBER NOT NULL ,
MOBILE VARCHAR2(16) NULL ,
NAME VARCHAR2(128) NULL ,
ORGANNAME VARCHAR2(128) NULL ,
PASSWORD VARCHAR2(512) NULL ,
USERTYPE NUMBER NULL ,
MAKEDATE DATE NULL ,
ISAPPROVED NUMBER NULL ,
PROVINCE NUMBER NULL ,
CITY NUMBER NULL ,
AREAS NUMBER NULL ,
APPROVEDATE DATE NULL ,
APPROVEID NUMBER NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN USER_APPLY.ID USERID '编号';

COMMENT ON COLUMN USER_APPLY.MOBILE IS '手机号';

COMMENT ON COLUMN USER_APPLY.NAME IS '姓名';

COMMENT ON COLUMN USER_APPLY.ORGANNAME IS '机构名称';

COMMENT ON COLUMN USER_APPLY.PASSWORD IS '密码';

COMMENT ON COLUMN USER_APPLY.USERTYPE IS '用户类型';

COMMENT ON COLUMN USER_APPLY.MAKEDATE IS '注册日期';

COMMENT ON COLUMN USER_APPLY.ISAPPROVED IS '是否已审批';

COMMENT ON COLUMN USER_APPLY.PROVINCE IS '省份';

COMMENT ON COLUMN USER_APPLY.CITY IS '市';

COMMENT ON COLUMN USER_APPLY.AREAS IS '区';

COMMENT ON COLUMN USER_APPLY.APPROVEDATE IS '审批日期';

COMMENT ON COLUMN USER_APPLY.APPROVEID IS '审批人';

ALTER TABLE USER_APPLY
ADD ( VERSION NUMBER DEFAULT 0 NULL  ) ;

COMMENT ON COLUMN USER_APPLY.VERSION IS '版本控制';

ALTER TABLE USER_APPLY
ADD ( REMARK VARCHAR2(512) NULL  ) ;

COMMENT ON COLUMN USER_APPLY.REMARK IS '备注';

CREATE SEQUENCE USER_APPLY_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;

INSERT INTO LEFT_MENU VALUES ('2312', '用户审批', 'd.add(2312,6,"用户审批","../users/listUserGroupAction.do","用户审批","","","");', '6', '2', '', '1', 505);

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='用户审批'),'用户审批','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='用户审批'),
'/users/listUserApplyAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'审批',(select id from LEFT_MENU where LMENUNAME='用户审批'),'用户审批','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='审批'and MODULENAME='用户审批'),
'/users/toApproveUserApplyAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='审批'and MODULENAME='用户审批'),
'/users/approveUserApplyAction.do');


ALTER TABLE USER_APPLY
MODIFY ( MOBILE VARCHAR2(256) ) ;

ALTER TABLE WLINKMAN
MODIFY ( MOBILE VARCHAR2(256) ) ;

ALTER TABLE OLINKMAN
MODIFY ( MOBILE VARCHAR2(256) ) ;

ALTER TABLE WAREHOUSE
MODIFY ( WAREHOUSETEL VARCHAR2(256) ) ;

ALTER TABLE TAKE_TICKET
MODIFY ( TEL VARCHAR2(256) ) ;


-----------------------2017-10-09---------------------

ALTER TABLE PRODUCT
ADD ( CODETYPE NUMBER NULL  ) 
ADD ( LINKMODE NUMBER NULL  ) 
ADD ( REGCERTTYPE NUMBER NULL  ) 
ADD ( REGCERTCODE VARCHAR2(256) NULL  ) 
ADD ( REGCERTUSER VARCHAR2(256) NULL  ) 
ADD ( STANDARDNAME VARCHAR2(256) NULL  ) 
ADD ( SPECCODE VARCHAR2(256) NULL  ) 
ADD ( PRODUCETYPE NUMBER NULL  ) 
ADD ( PRIMARYCODETYPE NUMBER NULL  ) ;

COMMENT ON COLUMN PRODUCT.CODETYPE IS '条码类型1.DM 2.QR';

COMMENT ON COLUMN PRODUCT.LINKMODE IS '关联模式1.前关联2.后关联';

COMMENT ON COLUMN PRODUCT.REGCERTTYPE IS '登记证类型';

COMMENT ON COLUMN PRODUCT.REGCERTCODE IS '登记证号';

COMMENT ON COLUMN PRODUCT.REGCERTUSER IS '登记证持有人';

COMMENT ON COLUMN PRODUCT.STANDARDNAME IS '农药标准名称';

COMMENT ON COLUMN PRODUCT.SPECCODE IS '产品规格代码';

COMMENT ON COLUMN PRODUCT.PRODUCETYPE IS '生产类型';

COMMENT ON COLUMN PRODUCT.PRIMARYCODETYPE IS '小包装码类型1.旧规则2.新规则';


ALTER TABLE PRINT_JOB
ADD ( SYNCSTATUS NUMBER NULL  ) 
ADD ( CODETYPE NUMBER NULL  ) 
ADD ( LINKMODE NUMBER NULL  )
ADD ( ISASSIGNED NUMBER NULL  ) ;

COMMENT ON COLUMN PRINT_JOB.SYNCSTATUS IS '同步状态0未同步1已上传2已回传';

COMMENT ON COLUMN PRINT_JOB.CODETYPE IS '条码类型1.DM 2.QR';

COMMENT ON COLUMN PRINT_JOB.LINKMODE IS '关联模式1.前关联2.后关联';

COMMENT ON COLUMN PRINT_JOB.ISASSIGNED IS '赋码是否已完成0.未完成1已完成';



ALTER TABLE PRODUCT
ADD ( CAREMATEMPLATE VARCHAR2(256) NULL  )
ADD ( INNERPRODUCETYPE NUMBER NULL  ) ;

COMMENT ON COLUMN PRODUCT.CAREMATEMPLATE IS '相机模板';
COMMENT ON COLUMN PRODUCT.INNERPRODUCETYPE IS '内部生产类型1代表杭州登记杭州制剂包装2代表AG登记杭州分装3代表AG登记外加工厂分装4代表第三方登记贸易引进产品,5-9用于后续扩展使用';


ALTER TABLE PRODUCT
ADD ( REGCERTCODEFIXED VARCHAR2(256) NULL  );

COMMENT ON COLUMN PRODUCT.REGCERTCODEFIXED IS '六位登记证号';


CREATE TABLE SEED (
ID NUMBER NOT NULL ,
YEAR NUMBER NULL ,
SEED VARCHAR2(4) NULL ,
CURRENTVALUE NUMBER NULL ,
ISUSED NUMBER NULL ,
MAKEDATE DATE NULL ,
TYPE NUMBER NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN SEED.ID IS '编号';

COMMENT ON COLUMN SEED.YEAR IS '年份';

COMMENT ON COLUMN SEED.SEED IS '种子';

COMMENT ON COLUMN SEED.CURRENTVALUE IS '当前值';

COMMENT ON COLUMN SEED.ISUSED IS '是否已使用';

COMMENT ON COLUMN SEED.MAKEDATE IS '创建日期';

COMMENT ON COLUMN SEED.TYPE IS '种子类型1普通码2通用码';

CREATE SEQUENCE SEED_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;

INSERT INTO TASK_QUARTZ VALUES ((select max(id)+1 from TASK_QUARTZ), '产品数据同步任务', null, null, '0', null, '0', null, null, '2', '产品数据同步任务', 'DealSyncProductTask', null, '30', null, null, null, null, '0', null, '1', null, null, null, null);
INSERT INTO TASK_QUARTZ VALUES ((select max(id)+1 from TASK_QUARTZ), '打印任务同步任务', null, null, '0', null, '0', null, null, '2', '打印任务同步任务', 'DealSyncPrintJobTask', null, '30', null, null, null, null, '0', null, '1', null, null, null, null);
INSERT INTO TASK_QUARTZ VALUES ((select max(id)+1 from TASK_QUARTZ), '生产数据处理任务', null, null, '0', null, '0', null, null, '2', '生产数据处理任务', 'DealProduceUploadTask', null, '30', null, null, null, null, '0', null, '1', null, null, null, null);


ALTER TABLE PRINT_JOB
ADD ( SYNCFILEPATH VARCHAR2(512) NULL  ) ;

COMMENT ON COLUMN PRINT_JOB.SYNCFILEPATH IS ' 同步文件保存路径';


CREATE TABLE UPLOAD_PRODUCE_LOG (
ID NUMBER NOT NULL ,
ISDEAL NUMBER NULL ,
FILENAME VARCHAR2(256 CHAR) NULL ,
FILEPATH VARCHAR2(256 CHAR) NULL ,
LOGFILEPATH VARCHAR2(256 CHAR) NULL ,
ERRORCOUNT NUMBER NULL ,
TOTALCOUNT NUMBER NULL ,
FILETYPE VARCHAR2(24 CHAR) NULL ,
MAKEID NUMBER NULL ,
MAKEORGANID VARCHAR2(50 CHAR) NULL ,
MAKEDEPTID NUMBER NULL ,
MAKEDATE DATE NULL ,
FILEHASHCODE VARCHAR2(512 CHAR) NULL,
PRIMARY KEY (ID)
)
LOGGING
NOCOMPRESS
NOCACHE

;
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.ID IS '序号';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.ISDEAL IS '处理标志（0，未处理，1正在处理，2正确处理，3处理错误）';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.FILENAME IS '上传文件名称';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.FILEPATH IS '上传文件路径';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.LOGFILEPATH IS '错误日志文件全名';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.ERRORCOUNT IS '错误记录数';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.TOTALCOUNT IS '总记录数';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.FILETYPE IS '文件类型（在baseresource中定义）';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.MAKEID IS '创建用户号';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.MAKEORGANID IS '创建机构号';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.MAKEDEPTID IS '创建部门号（目前不用）';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.MAKEDATE IS '创建日期';
COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.FILEHASHCODE IS '文件对比码（判断是否同一文件使用）';


ALTER TABLE UPLOAD_PRODUCE_LOG
ADD ( PRINTJOBID NUMBER NULL  ) ;

COMMENT ON COLUMN UPLOAD_PRODUCE_LOG.PRINTJOBID IS '打印任务编号';

CREATE SEQUENCE UPLOAD_PRODUCE_LOG_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;


INSERT INTO LEFT_MENU VALUES ('713', '生产数据上传日志', 'd.add(713,7,"生产数据上传日志","../machin/listProduceUploadAction.do","生产数据上传日志","","","");', '7', '2', '', '1', (select max(sort)+ 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='生产数据上传日志'),'生产数据上传日志','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='生产数据上传日志'),
'/machin/listProduceUploadAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'重新处理',(select id from LEFT_MENU where LMENUNAME='生产数据上传日志'),'生产数据上传日志','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='重新处理'and MODULENAME='生产数据上传日志'),
'/machin/reProcessProduceFileAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'上传',(select id from LEFT_MENU where LMENUNAME='生产数据上传日志'),'生产数据上传日志','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='上传'and MODULENAME='生产数据上传日志'),
'/machin/toUploadProduceAction.do');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='上传'and MODULENAME='生产数据上传日志'),
'/machin/uploadProduceAction.do'); 

------------2017-10-20---------------------
ALTER TABLE COMMON_CODE_LOG
ADD ( SYNCSTATUS NUMBER NULL  ) ;

COMMENT ON COLUMN COMMON_CODE_LOG.SYNCSTATUS IS '同步状态';

ALTER TABLE COMMON_CODE_LOG
ADD ( SYNCFILEPATH VARCHAR2(512) NULL  ) ;

COMMENT ON COLUMN COMMON_CODE_LOG.SYNCFILEPATH IS '同步文件路径';



------------2017-10-20----添加质量检验表-----------------
CREATE TABLE QUALITY_INSPECTION (
ID NUMBER NOT NULL ,
MCODE VARCHAR2(32) NULL ,
BATCH VARCHAR2(32) NULL ,
INSPECTOR VARCHAR2(256) NULL ,
INSPECTDATE DATE NULL ,
ISQUALIFIED NUMBER NULL ,
MAKEID NUMBER NULL ,
MAKEDATE DATE NULL ,
FILEPATH VARCHAR2(512) NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN QUALITY_INSPECTION.ID IS '编号';

COMMENT ON COLUMN QUALITY_INSPECTION.MCODE IS '物料号';

COMMENT ON COLUMN QUALITY_INSPECTION.BATCH IS '批次';

COMMENT ON COLUMN QUALITY_INSPECTION.INSPECTOR IS '质检员';

COMMENT ON COLUMN QUALITY_INSPECTION.INSPECTDATE IS '质检日期';

COMMENT ON COLUMN QUALITY_INSPECTION.ISQUALIFIED IS '是否合格';

COMMENT ON COLUMN QUALITY_INSPECTION.MAKEID IS '制单人';

COMMENT ON COLUMN QUALITY_INSPECTION.MAKEDATE IS '制单日期';

COMMENT ON COLUMN QUALITY_INSPECTION.FILEPATH IS '质检报告路径';

CREATE SEQUENCE QUALITY_INSPECTION_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;

INSERT INTO LEFT_MENU VALUES ('714', '质量检验', 'd.add(714,7,"质量检验","../machin/listQualityInspectionAction.do","质量检验","","","");', '7', '2', '', '1', (select max(sort)+ 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='质量检验'),'质量检验','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='质量检验'),
'/machin/listQualityInspectionAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'新增',(select id from LEFT_MENU where LMENUNAME='质量检验'),'质量检验','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='质量检验'),
'/machin/toAddQualityInspectionAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='质量检验'),
'/machin/addQualityInspectionAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'删除',(select id from LEFT_MENU where LMENUNAME='质量检验'),'质量检验','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='删除'and MODULENAME='质量检验'),
'/machin/delQualityInspectionAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'更新',(select id from LEFT_MENU where LMENUNAME='质量检验'),'质量检验','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='更新'and MODULENAME='质量检验'),
'/machin/toUpdQualityInspectionAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='更新'and MODULENAME='质量检验'),
'/machin/updQualityInspectionAction.do');


CREATE TABLE APPLY_QR_CODE (
ID NUMBER NOT NULL ,
ORGANID VARCHAR2(32) NULL ,
PRODUCTID VARCHAR2(32) NULL ,
QUANTITY NUMBER NULL ,
REDUNDANCE NUMBER NULL ,
STATUS NUMBER NULL ,
FILEPATH VARCHAR2(512) NULL ,
AUDITDATE DATE NULL ,
AUDITID NUMBER NULL ,
MAKEDATE DATE NULL ,
MAKEID NUMBER NULL ,
VERSION NUMBER NULL ,
ISAUDIT NUMBER NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN APPLY_QR_CODE.ORGANID IS '机构编号';

COMMENT ON COLUMN APPLY_QR_CODE.PRODUCTID IS '产品编号';

COMMENT ON COLUMN APPLY_QR_CODE.QUANTITY IS '数量';

COMMENT ON COLUMN APPLY_QR_CODE.REDUNDANCE IS '冗余量(百分比)';

COMMENT ON COLUMN APPLY_QR_CODE.STATUS IS '状态1.未生成2生成中3已生成4生成失败';

COMMENT ON COLUMN APPLY_QR_CODE.FILEPATH IS '码文件路径';

COMMENT ON COLUMN APPLY_QR_CODE.AUDITDATE IS '审核日期';

COMMENT ON COLUMN APPLY_QR_CODE.AUDITID IS '审核人';

COMMENT ON COLUMN APPLY_QR_CODE.MAKEDATE IS '制单日期';

COMMENT ON COLUMN APPLY_QR_CODE.MAKEID IS '制单人';

COMMENT ON COLUMN APPLY_QR_CODE.ISAUDIT IS '审核状态0未审核1已审核';

CREATE INDEX CS_IX1
ON CARTON_SEQ (PRODUCTID ASC);

CREATE INDEX CS_IX2
ON CARTON_SEQ (SEQ ASC);

CREATE INDEX CS_IX3
ON CARTON_SEQ (CARTONCODE ASC);



CREATE SEQUENCE APPLY_QR_CODE_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;

INSERT INTO LEFT_MENU VALUES ('2336', '码申请', 'd.add(2336,10,"码申请","../erp/listApplyQrCodeAction.do","码申请","","","");', '10', '2', '', '1', (select max(sort)+ 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='码申请'),'码申请','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='码申请'),
'/erp/listApplyQrCodeAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'新增',(select id from LEFT_MENU where LMENUNAME='码申请'),'码申请','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='码申请'),
'/erp/toAddApplyQrCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='码申请'),
'/erp/addApplyQrCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',1,'/common/selectTollerProductAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'修改',(select id from LEFT_MENU where LMENUNAME='码申请'),'码申请','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='码申请'),
'/erp/toUpdApplyQrCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='码申请'),
'/erp/updApplyQrCodeAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'删除',(select id from LEFT_MENU where LMENUNAME='码申请'),'码申请','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='删除'and MODULENAME='码申请'),
'/erp/delApplyQrCodeAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'审批',(select id from LEFT_MENU where LMENUNAME='码申请'),'码申请','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='审批'and MODULENAME='码申请'),
'/erp/auditApplyQrCodeAction.do');


----2017-11-01--
CREATE TABLE CARTON_SEQ (
ID NUMBER NOT NULL ,
PRODUCTID VARCHAR2(32) NULL ,
SEQ VARCHAR2(10) NULL ,
STATUS NUMBER NULL ,
MAKEDATE DATE NULL ,
VERSION NUMBER NULL ,
APPLYID NUMBER NULL ,
CARTONCODE VARCHAR2(32) NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN CARTON_SEQ.PRODUCTID IS '产品编号';

COMMENT ON COLUMN CARTON_SEQ.SEQ IS '箱序号';

COMMENT ON COLUMN CARTON_SEQ.STATUS IS '使用状态0未使用1已使用2已拆包';

COMMENT ON COLUMN CARTON_SEQ.MAKEDATE IS '生成日期';

COMMENT ON COLUMN CARTON_SEQ.APPLYID IS '码申请编号';

COMMENT ON COLUMN CARTON_SEQ.CARTONCODE IS 'SSCC CODE';


CREATE SEQUENCE CARTON_SEQ_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;

INSERT INTO TASK_QUARTZ VALUES ((select max(id)+1 from TASK_QUARTZ), '分装厂码申请处理任务', null, null, '0', null, '0', null, null, '2', '分装厂码申请处理任务', 'AutoTollerPrimaryCodeGenTask', null, '30', null, null, null, null, '0', null, '1', null, null, null, null);


ALTER TABLE APPLY_QR_CODE
ADD ( PONO VARCHAR2(32) NULL  ) ;

COMMENT ON COLUMN APPLY_QR_CODE.PONO IS 'PO单号';


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'箱码序号关联',(select id from LEFT_MENU where LMENUNAME='生产计划'),'生产计划','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='箱码序号关联'and MODULENAME='生产计划'),
'/erp/toSelectCartonSeqAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='箱码序号关联'and MODULENAME='生产计划'),
'/erp/selectCartonSeqAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='箱码序号关联'and MODULENAME='生产计划'),
'/erp/updSelectedCartonSeqAction.do');

ALTER TABLE PRODUCTPLAN
ADD ( CARTONSEQFLAG NUMBER DEFAULT 0 NULL  ) ;

COMMENT ON COLUMN PRODUCTPLAN.CARTONSEQFLAG IS '箱序号关联状态';


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'经营产品',(select id from LEFT_MENU where LMENUNAME='机构设置'),'机构设置','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='经营产品'and MODULENAME='机构设置'),
'/users/listOrganProductAlreadyAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='经营产品'and MODULENAME='机构设置'),
'/users/listOrganProductForSelectAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='经营产品'and MODULENAME='机构设置'),
'/users/delOrganProductAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='经营产品'and MODULENAME='机构设置'),
'/users/setOrganProductAction.do');

ALTER TABLE PRINT_JOB
ADD ( CARTONSEQSTATUS NUMBER NULL  ) ;

COMMENT ON COLUMN PRINT_JOB.CARTONSEQSTATUS IS '关联箱序号状态';


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'箱码序号关联',(select id from LEFT_MENU where LMENUNAME='打印任务'),'打印任务','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='箱码序号关联'and MODULENAME='打印任务'),
'/sap/toSelectCartonSeqAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='箱码序号关联'and MODULENAME='打印任务'),
'/sap/selectCartonSeqAction.do');


CREATE TABLE CARTON_SEQ_LOG (
ID NUMBER NOT NULL ,
ORGANID VARCHAR2(32) NULL ,
PRODUCTID VARCHAR2(32) NULL ,
RANGE VARCHAR2(512) NULL ,
MAKEDATE DATE NULL ,
MAKEID NUMBER NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN CARTON_SEQ_LOG.ORGANID IS '机构编号';

COMMENT ON COLUMN CARTON_SEQ_LOG.PRODUCTID IS '产品编号';

COMMENT ON COLUMN CARTON_SEQ_LOG.RANGE IS '激活序号范围';

COMMENT ON COLUMN CARTON_SEQ_LOG.MAKEDATE IS '制单日期';

COMMENT ON COLUMN CARTON_SEQ_LOG.MAKEID IS '制单人';

CREATE SEQUENCE CARTON_SEQ_LOG_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;

INSERT INTO LEFT_MENU VALUES ('2337', '箱码序号激活', 'd.add(2337,10,"箱码序号激活","../erp/listCartonSeqLogAction.do","箱码序号激活","","","");', '10', '2', '', '1', (select max(sort)+ 1 from LEFT_MENU));

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='箱码序号激活'),'箱码序号激活','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='箱码序号激活'),
'/erp/listCartonSeqLogAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'新增',(select id from LEFT_MENU where LMENUNAME='箱码序号激活'),'箱码序号激活','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='箱码序号激活'),
'/erp/toAddCartonSeqLogAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='箱码序号激活'),
'/erp/addCartonSeqLogAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',1,'/erp/ajaxGetAvailableRange.do');


ALTER TABLE COVERT_ERROR_LOG
MODIFY ( PRIMARY_CODE VARCHAR2(32) ) ;


CREATE INDEX "DBOBCSRTCI20141114"."TTI_IX_2"
ON "DBOBCSRTCI20141114"."TAKE_TICKET_IDCODE" ("TTID" ASC);
----------updated to bcs-------------


------2017-11-28-------------
ALTER TABLE LEFT_MENU
ADD ( LMENUNAME_EN VARCHAR2(256) NULL  ) ;

COMMENT ON COLUMN LEFT_MENU.LMENUNAME_EN IS '菜单英文名称';

update LEFT_MENU set LMENUNAME_EN=LMENUURL

update LEFT_MENU set lmenuname_en='d.add(10,1,"Tolling","","Tolling","","","");' where lmenuname = '分装厂'

update LEFT_MENU set lmenuname_en='d.add(2336,10,"Apply For QR Code","../erp/listApplyQrCodeAction.do","Apply For QR Code","","","");' where lmenuname = '码申请'

update LEFT_MENU set lmenuname_en='d.add(2337,10,"Carton Sequence Activation","../erp/listCartonSeqLogAction.do","Carton Sequence Activation","","","");' where lmenuname = '箱码序号激活'


---2017-12-04--条码替换临时表-----
CREATE TABLE CODE_REPLACE (
PRIMARYCODE VARCHAR2(32) NOT NULL ,
CARTONCODE VARCHAR2(32) NULL ,
PRODUCTPLANID NUMBER NULL ,
PRIMARY KEY (PRIMARYCODE)
)
NOCOMPRESS
;

COMMENT ON COLUMN CODE_REPLACE.PRIMARYCODE IS '小包装码';

COMMENT ON COLUMN CODE_REPLACE.CARTONCODE IS '箱码';

COMMENT ON COLUMN CODE_REPLACE.PRODUCTPLANID IS '生产计划编号';

----箱序号激活表添加批次---------
ALTER TABLE CARTON_SEQ_LOG
ADD ( BATCH VARCHAR2(32) NULL  ) ;

COMMENT ON COLUMN CARTON_SEQ_LOG.BATCH IS '批次号';

---添加分装厂码替换任务----
INSERT INTO TASK_QUARTZ VALUES ((select max(id)+1 from TASK_QUARTZ), '分装厂码替换处理任务', null, null, '0', null, '0', null, null, '2', '分装厂码替换处理任务', 'AutoDealCodeReplaceTask', null, '30', null, null, null, null, '0', null, '1', null, null, null, null);

INSERT INTO LEFT_MENU VALUES ('2338', '码替换', 'd.add(2338,10,"码替换","../erp/listCodeReplaceAction.do","码替换","","","");', '10', '2', '', '1', (select max(sort)+ 1 from LEFT_MENU),'d.add(2338,10,"码替换","../erp/listCodeReplaceAction.do","码替换","","","");');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='码替换'),'码替换','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='码替换'),
'/erp/listCodeReplaceAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'重新处理',(select id from LEFT_MENU where LMENUNAME='码替换'),'码替换','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='重新处理'and MODULENAME='码替换'),
'/erp/reProcessReplaceCodeAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'上传',(select id from LEFT_MENU where LMENUNAME='码替换'),'码替换','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='上传'and MODULENAME='码替换'),
'/erp/toUploadReplaceCodeAction.do');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='上传'and MODULENAME='码替换'),
'/erp/uploadReplaceCodeAction.do'); 

---2017-12-05--码申请表添加字段----------
ALTER TABLE APPLY_QR_CODE 
ADD ( NEEDCOVERTCODE NUMBER NULL  ) ;

COMMENT ON COLUMN APPLY_QR_CODE.NEEDCOVERTCODE IS '是否需要暗码';

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='箱码序号关联'and MODULENAME='生产计划'),
'/erp/downloadSelectedCartonSeqAction.do');

ALTER TABLE CARTON_SEQ_LOG
ADD ( PRODUCTIONDATE DATE NULL  ) 
ADD ( PACKINGDATE DATE NULL  ) 
ADD ( INSPECTIONDATE DATE NULL  ) 
ADD ( INSPECTIONINSTITUTION VARCHAR2(256) NULL  ) ;

COMMENT ON COLUMN CARTON_SEQ_LOG.PRODUCTIONDATE IS '生产日期';

COMMENT ON COLUMN CARTON_SEQ_LOG.PACKINGDATE IS '分装日期';

COMMENT ON COLUMN CARTON_SEQ_LOG.INSPECTIONDATE IS '检验日期';

COMMENT ON COLUMN CARTON_SEQ_LOG.INSPECTIONINSTITUTION IS '检验单位';


----2018--01--08----
ALTER TABLE PRODUCT
ADD ( PRODUCTTYPE NUMBER NULL  ) ;

COMMENT ON COLUMN PRODUCT.PRODUCTTYPE IS '产品类型';


----2018--11--26--新增TD库存文件传输任务--
INSERT INTO TASK_QUARTZ (ID, TASK_NAME, START_DATETIME, END_DATETIME, STATUS, DEPEND_ON_TASK_ID, OPERATION, PARENT_JOB, CHILD_JOB, TYPE, REMARK, PERFORM_CLASS, IS_BIND_PERFORM_THREAD, CYCLE_JOB_INTERVAL, CREATE_USER_ID, CREATE_DATE, UPDATE_USER_ID, UPDATE_DATE, IS_DELETE, CREATE_ORGAN_ID, DELAY_TYPE, CRON_EXPRESSION, TASK_CATEGORY, OTHERID) 
select (select max(id)+1 from TASK_QUARTZ), 'TD库存文件传输任务', NULL, NULL, '0', NULL, '0', NULL, NULL, '2', 'TD库存文件传输任务', 'AutoCreateTransferInventoryFileTask', NULL, '1', NULL, NULL, NULL, NULL, '0', NULL, '2', '0 0 22 * * ? *', NULL, NULL from dual


----2019--05--24--新建处理SAP条码文件时的临时表--
create global temporary table transaction_temp_preapare_code (code VARCHAR2(32)) on commit delete rows;  


----2019--06--17--
INSERT INTO BASE_RESOURCE (ID, TAGNAME, TAGSUBKEY, TAGSUBVALUE, ISDEFAULT, ISUSE) 
select (select max(id)+1 FROM BASE_RESOURCE), 'SalesUserType', '5', 'CM', NULL, '1' from dual;

INSERT INTO BASE_RESOURCE (ID, TAGNAME, TAGSUBKEY, TAGSUBVALUE, ISDEFAULT, ISUSE) 
select (select max(id)+1 FROM BASE_RESOURCE), 'dupDeliveryIdcodeTime', '1', '2015-01-01 00:00:00', NULL, '1' from dual;

update MAKE_CONF set currentvalue=(select max(id)+1 FROM BASE_RESOURCE) where tablename='base_resource';

INSERT INTO TASK_QUARTZ (TASK_NAME, START_DATETIME, END_DATETIME, STATUS, DEPEND_ON_TASK_ID, OPERATION, PARENT_JOB, CHILD_JOB, TYPE, REMARK, PERFORM_CLASS, IS_BIND_PERFORM_THREAD, CYCLE_JOB_INTERVAL, CREATE_USER_ID, CREATE_DATE, UPDATE_USER_ID, UPDATE_DATE, IS_DELETE, CREATE_ORGAN_ID, DELAY_TYPE, CRON_EXPRESSION, TASK_CATEGORY, OTHERID) 
select '发货重码检查任务', NULL, NULL, '0', NULL, '0', NULL, NULL, '2', '发货重码检查任务', 'DealCheckDuplicateDeliveryIdcodeTask', NULL, '30', NULL, NULL, NULL, NULL, '0', NULL, '0', NULL, NULL, NULL from dual;

CREATE TABLE DUPLICATE_DELIVERY_IDCODE (
ID NUMBER NOT NULL ,
IDCODE VARCHAR2(64) NULL ,
PRODUCTID VARCHAR2(32) NULL ,
BATCH VARCHAR2(32) NULL ,
BILLNO VARCHAR2(32) NULL ,
NCCODE VARCHAR2(32) NULL ,
OUTOID VARCHAR2(32) NULL ,
OUTWID VARCHAR2(32) NULL ,
OUTDATE DATE NULL ,
INOID VARCHAR2(32) NULL ,
INWID VARCHAR2(32) NULL ,
ISRECEIVE NUMBER NULL ,
RECEIVEDATE DATE NULL ,
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.IDCODE IS '箱码号';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.PRODUCTID IS '产品编号';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.BATCH IS '批号';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.BILLNO IS '发货单号';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.NCCODE IS 'SAP单号';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.OUTOID IS '发货机构编号';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.OUTWID IS '发货仓库编号';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.OUTDATE IS '发货日期';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.INOID IS '收货机构编号';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.INWID IS '收货仓库编号';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.ISRECEIVE IS '是否已签收';

COMMENT ON COLUMN DUPLICATE_DELIVERY_IDCODE.RECEIVEDATE IS '收货日期';


CREATE SEQUENCE DUPLICATE_DELIVERY_IDCODE_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;

--重建邮件表--
alter table B_PROC_BATCH_COMPLETE_MAIL rename to B_PROC_BATCH_COMPLETE_MAIL_BAK;

CREATE TABLE B_PROC_BATCH_COMPLETE_MAIL 
   (	MAIL_ID NUMBER NOT NULL ENABLE, 
	MAIL_SENDER VARCHAR2(256), 
	MAIL_FROM VARCHAR2(256), 
	MAIL_TO VARCHAR2(256), 
	MAIL_CC VARCHAR2(256), 
	MAIL_BCC VARCHAR2(256), 
	MAIL_SUBJECT VARCHAR2(512), 
	MAIL_BODY CLOB, 
	MAIL_ATTACHMENT VARCHAR2(1024), 
	CREATE_DATE DATE, 
	SENT_DATE DATE, 
	IS_SENT NUMBER, 
	WRONG_TIMES NUMBER, 
	MOBLIE_APPROVAL_ID VARCHAR2(128), 
	MISS_MAIL_ADDRESS VARCHAR2(256), 
	MAILTYPE NUMBER, 
	MAIL_DATE_TYPE VARCHAR2(32), 
	PRIMARY KEY (MAIL_ID)
)
--条码上传时间字段添加索引
create index TTI_IX_3 on TAKE_TICKET_IDCODE (MAKEDATE ASC) nologging ONLINE;

--重码检查临时表
create global temporary table transaction_temp_dup_delivery (IDCODE VARCHAR2(64),ORGANTYPE NUMBER(1)) on commit delete rows;  


---create global temporary table transaction_temp_dup_return (IDCODE VARCHAR2(64),ORGANTYPE NUMBER(1)) on commit delete rows;  

--新增发货单重码统计菜单
INSERT INTO LEFT_MENU VALUES ('3037', '发货单重码统计', 'd.add(3037,30,"发货单重码统计","../report/dupDeliveryIdcodeReportAction.do","发货单重码统计","","","");', '30', '2', '', '1', (select max(sort)+ 1 from LEFT_MENU),'d.add(3037,30,"发货单重码统计","../report/dupDeliveryIdcodeReportAction.do","发货单重码统计","","","");');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='发货单重码统计'),'发货单重码统计','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='发货单重码统计'),
'/report/dupDeliveryIdcodeReportAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'导出',(select id from LEFT_MENU where LMENUNAME='发货单重码统计'),'发货单重码统计','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='导出'and MODULENAME='发货单重码统计'),
'/report/excPutDupDeliveryIdcodeReportAction.do');



--2019-07-19-------
--新增云单页参数配置菜单--
INSERT INTO LEFT_MENU VALUES ('5007', '参数配置', 'd.add(5007,50,"参数配置","../yun/listConfigAction.do","参数配置","","","");', '50', '2', '', '1', (select max(sort)+ 1 from LEFT_MENU),'d.add(5007,50,"参数配置","../report/dupDeliveryIdcodeReportAction.do","参数配置","","","");');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='参数配置'),'参数配置','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='参数配置'),
'/yun/listConfigAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='参数配置'),
'/sys/listBaseResourceAction.do');

INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'修改',(select id from LEFT_MENU where LMENUNAME='参数配置'),'参数配置','1');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='参数配置'),
'/sys/toUpdBaseResourceAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='参数配置'),
'/sys/updBaseResourceAction.do');

--新增商城地址配置信息---
INSERT INTO BASE_RESOURCE (ID, TAGNAME, TAGSUBKEY, TAGSUBVALUE, ISDEFAULT, ISUSE) 
select (select max(id)+1 FROM BASE_RESOURCE), 'OnlineShopUrl', '1', '商城地址填写此处', NULL, '1' from dual;

update MAKE_CONF set CURRENTVALUE=(select max(id)+1 FROM BASE_RESOURCE) where TABLENAME='base_resource';



---2019-08-03---新增码申请菜单--
INSERT INTO LEFT_MENU (ID, LMENUNAME, LMENUURL, LMENUPARENTID, LMENULEVEL, LMENUORDER, ISVISIBLE, SORT, LMENUNAME_EN) 
VALUES ('715', '杭州工厂码申请', 'd.add(715,7,码申请,../machin/listApplyQrCodeAction.do,码申请,,,);', '7', '2', NULL, '1', (select max(sort)+ 1 from LEFT_MENU), 'd.add(715,7,码申请,../machin/listApplyQrCodeAction.do,码申请,,,);');


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='杭州工厂码申请'),'杭州工厂码申请','1');
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'新增',(select id from LEFT_MENU where LMENUNAME='杭州工厂码申请'),'杭州工厂码申请','1');
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'修改',(select id from LEFT_MENU where LMENUNAME='杭州工厂码申请'),'杭州工厂码申请','1');
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'删除',(select id from LEFT_MENU where LMENUNAME='杭州工厂码申请'),'杭州工厂码申请','1');
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'审批',(select id from LEFT_MENU where LMENUNAME='杭州工厂码申请'),'杭州工厂码申请','1');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='杭州工厂码申请'),
'/machin/listApplyQrCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='杭州工厂码申请'),
'/machin/addApplyQrCodeAction.do');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='杭州工厂码申请'),
'/machin/toAddApplyQrCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='杭州工厂码申请'),
'/machin/updApplyQrCodeAction.do');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='杭州工厂码申请'),
'/machin/toUpdApplyQrCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='删除'and MODULENAME='杭州工厂码申请'),
'/machin/delApplyQrCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='审批'and MODULENAME='杭州工厂码申请'),
'/machin/auditApplyQrCodeAction.do');

UPDATE LEFT_MENU SET LMENUNAME='码申请' where LMENUNAME='杭州工厂码申请';

UPDATE OPERATE SET MODULENAME='码申请' where MODULENAME='杭州工厂码申请';


---新增Query序列---
select max(id)+1000 from QUERY;

CREATE SEQUENCE QUERY_SEQ
INCREMENT BY 1
START WITH 1--此处替换上一个查询语句查询出来的数据
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;

create global temporary table transaction_temp_carton_seq (PRIMARYCODE VARCHAR2(32),CARTONCODE VARCHAR2(32),PLANID INT, ERRORCODE INT) on commit delete rows;  



--新增定时任务--
INSERT INTO TASK_QUARTZ (TASK_NAME, START_DATETIME, END_DATETIME, STATUS, DEPEND_ON_TASK_ID, OPERATION, PARENT_JOB, CHILD_JOB, TYPE, REMARK, PERFORM_CLASS, IS_BIND_PERFORM_THREAD, CYCLE_JOB_INTERVAL, CREATE_USER_ID, CREATE_DATE, UPDATE_USER_ID, UPDATE_DATE, IS_DELETE, CREATE_ORGAN_ID, DELAY_TYPE, CRON_EXPRESSION, TASK_CATEGORY, OTHERID) 
VALUES ('CSSI文件生成任务', NULL, NULL, '0', NULL, '0', NULL, NULL, '2', 'CSSI文件生成任务', 'AutoCreateCSSITransferFileTask', NULL, '2', NULL, NULL, NULL, NULL, '0', NULL, '1', '0 0 11 * * ? *', NULL, NULL);

--设置统计数据的起始时间---
INSERT INTO BASE_RESOURCE (ID, TAGNAME, TAGSUBKEY, TAGSUBVALUE, ISUSE) 
SELECT (SELECT min(ID)-2 from BASE_RESOURCE),'CSSITime','1','2019-10-29 00:00:00',1 from dual


--新建短信通知日志表
CREATE TABLE NOTIFICATION_LOG (
DELIVERYNO VARCHAR2(32) NOT NULL ,
CODE VARCHAR2(32) NOT NULL ,
MAKEDATE DATE NULL ,
PRIMARY KEY (DELIVERYNO)
)
NOCOMPRESS
;

COMMENT ON COLUMN NOTIFICATION_LOG.DELIVERYNO IS '发货单号';

COMMENT ON COLUMN NOTIFICATION_LOG.CODE IS '编码';

COMMENT ON COLUMN NOTIFICATION_LOG.MAKEDATE IS '制单日期';



---2020-02-10---新增码申请菜单--
INSERT INTO LEFT_MENU (ID, LMENUNAME, LMENUURL, LMENUPARENTID, LMENULEVEL, LMENUORDER, ISVISIBLE, SORT, LMENUNAME_EN) 
VALUES ('716', '刮刮码申请', 'd.add(716,7,"刮刮码申请","../machin/listApplyScratchCodeAction.do","刮刮码申请","","","");', '7', '2', '', '1', (select max(sort) + 1 from LEFT_MENU),'d.add(716,7,"刮刮码申请","../machin/listSBonusConfigAction.do","刮刮码申请","","","");');


INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'查看',(select id from LEFT_MENU where LMENUNAME='刮刮码申请'),'刮刮码申请','1');
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'新增',(select id from LEFT_MENU where LMENUNAME='刮刮码申请'),'刮刮码申请','1');
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'修改',(select id from LEFT_MENU where LMENUNAME='刮刮码申请'),'刮刮码申请','1');
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'删除',(select id from LEFT_MENU where LMENUNAME='刮刮码申请'),'刮刮码申请','1');
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'审批',(select id from LEFT_MENU where LMENUNAME='刮刮码申请'),'刮刮码申请','1');
INSERT into OPERATE VALUES((SELECT MAX(ID)+1 from OPERATE),'下载',(select id from LEFT_MENU where LMENUNAME='刮刮码申请'),'刮刮码申请','1');


INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='查看'and MODULENAME='刮刮码申请'),
'/machin/listApplyScratchCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='刮刮码申请'),
'/machin/addApplyScratchCodeAction.do');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='新增'and MODULENAME='刮刮码申请'),
'/machin/toAddApplyScratchCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='刮刮码申请'),
'/machin/updApplyScratchCodeAction.do');
INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='修改'and MODULENAME='刮刮码申请'),
'/machin/toUpdApplyScratchCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='删除'and MODULENAME='刮刮码申请'),
'/machin/delApplyScratchCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='审批'and MODULENAME='刮刮码申请'),
'/machin/auditApplyScratchCodeAction.do');

INSERT into MENU VALUES((SELECT MAX(ID)+1 from MENU),'',(select ID from OPERATE where OPERATENAME='下载'and MODULENAME='刮刮码申请'),
'/machin/downloadApplyScratchCodeAction.do');


CREATE TABLE APPLY_SCRATCH_CODE (
ID NUMBER NOT NULL ,
ORGANID VARCHAR2(32) NULL ,
PRODUCTID VARCHAR2(32) NULL ,
QUANTITY NUMBER NULL ,
REDUNDANCE NUMBER NULL ,
STATUS NUMBER NULL ,
FILEPATH VARCHAR2(512) NULL ,
AUDITDATE DATE NULL ,
AUDITID NUMBER NULL ,
MAKEDATE DATE NULL ,
MAKEID NUMBER NULL ,
VERSION NUMBER NULL ,
ISAUDIT NUMBER NULL ,
PONO VARCHAR2(32), 
PRIMARY KEY (ID)
)
NOCOMPRESS
;

COMMENT ON COLUMN APPLY_SCRATCH_CODE.ORGANID IS '机构编号';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.PRODUCTID IS '产品编号';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.QUANTITY IS '数量';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.REDUNDANCE IS '冗余量(百分比)';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.STATUS IS '状态1.未生成2生成中3已生成4生成失败';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.FILEPATH IS '码文件路径';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.AUDITDATE IS '审核日期';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.AUDITID IS '审核人';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.MAKEDATE IS '制单日期';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.MAKEID IS '制单人';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.ISAUDIT IS '审核状态0未审核1已审核';

COMMENT ON COLUMN APPLY_SCRATCH_CODE.PONO IS '工单号';

CREATE SEQUENCE APPLY_SCRATCH_CODE_SEQ
INCREMENT BY 1
START WITH 1
 MAXVALUE 9999999999999999999999999999
 NOMINVALUE
NOCYCLE
NOORDER;